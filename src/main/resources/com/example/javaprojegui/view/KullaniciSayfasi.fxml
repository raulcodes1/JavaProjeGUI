<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.chart.*?>

<AnchorPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.example.javaprojegui.controller.UserController"
            prefWidth="900" prefHeight="650">

    <TabPane
            fx:id="mainTabPane"
            styleClass="full-width-tabs"
            AnchorPane.topAnchor="0"
            AnchorPane.bottomAnchor="0"
            AnchorPane.leftAnchor="0"
            AnchorPane.rightAnchor="0">

        <!-- ================= ANA SAYFA ================= -->
        <Tab text="Home">
            <AnchorPane>

                <!-- WELCOME -->
                <VBox AnchorPane.topAnchor="15"
                      AnchorPane.leftAnchor="20"
                      spacing="5">
                    <Label fx:id="lblWelcome"
                           text="Welcome"
                           style="-fx-font-size: 20px; -fx-font-weight: bold;"/>
                    <Label fx:id="lblTarih"
                           text="Today's Date"/>
                </VBox>

                <!-- SUMMARY CARDS -->
                <HBox spacing="15"
                      AnchorPane.topAnchor="80"
                      AnchorPane.leftAnchor="20"
                      AnchorPane.rightAnchor="20">

                    <VBox prefHeight="80"
                          HBox.hgrow="ALWAYS"
                          style="-fx-background-color:#4CAF50;-fx-padding:10;">
                        <Label text="Total Materials" style="-fx-text-fill:white;"/>
                        <Label fx:id="lblToplam"
                               style="-fx-font-size:24px;-fx-text-fill:white;"/>
                    </VBox>

                    <VBox prefHeight="80"
                          HBox.hgrow="ALWAYS"
                          style="-fx-background-color:#F44336;-fx-padding:10;">
                        <Label text="Critical Stock" style="-fx-text-fill:white;"/>
                        <Label fx:id="lblKritik"
                               style="-fx-font-size:24px;-fx-text-fill:white;"/>
                    </VBox>

                    <VBox prefHeight="80"
                          HBox.hgrow="ALWAYS"
                          style="-fx-background-color:#2196F3;-fx-padding:10;">
                        <Label text="Material Types" style="-fx-text-fill:white;"/>
                        <Label fx:id="lblTur"
                               style="-fx-font-size:24px;-fx-text-fill:white;"/>
                    </VBox>

                    <VBox prefHeight="80"
                          HBox.hgrow="ALWAYS"
                          style="-fx-background-color:#FF9800;-fx-padding:10;">
                        <Label text="Cart" style="-fx-text-fill:white;"/>
                        <Label fx:id="lblSepet"
                               style="-fx-font-size:24px;-fx-text-fill:white;"/>
                    </VBox>
                </HBox>

                <!-- BOTTOM AREA -->
                <HBox spacing="20"
                      AnchorPane.topAnchor="190"
                      AnchorPane.leftAnchor="20"
                      AnchorPane.rightAnchor="20"
                      AnchorPane.bottomAnchor="20">

                    <!-- LEFT: ALERTS -->
                    <VBox spacing="10" prefWidth="260">
                        <Label text="Alerts"
                               style="-fx-font-size:16px;-fx-font-weight:bold;"/>
                        <ListView fx:id="uyariListView"
                                  VBox.vgrow="ALWAYS"/>
                    </VBox>

                    <!-- CENTER: RECENT ACTIVITIES -->
                    <VBox spacing="10" HBox.hgrow="ALWAYS">
                        <Label text="Recent Activities"
                               style="-fx-font-size:16px;-fx-font-weight:bold;"/>
                        <TableView fx:id="sonIslemlerTable"
                                   VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="colTarih"
                                             text="Date"
                                             prefWidth="120"/>
                                <TableColumn fx:id="colIslem"
                                             text="Action"
                                             prefWidth="160"/>
                                <TableColumn fx:id="colMalzeme"
                                             text="Material"
                                             prefWidth="200"/>
                            </columns>
                        </TableView>
                    </VBox>

                    <!-- RIGHT: CHART -->
                    <VBox spacing="10"
                          prefWidth="320"
                          style="-fx-padding:15;">

                        <Label text="Material Category Distribution"
                               style="-fx-font-size:16px;-fx-font-weight:bold;"/>

                        <PieChart fx:id="kategoriPieChart"
                                  prefHeight="300"/>

                        <Label text="Chart based on CSV data"/>
                    </VBox>

                </HBox>

            </AnchorPane>
        </Tab>

        <!-- ================= MALZEMELER ================= -->
        <Tab text="Materials" fx:id="tabMalzemeler">
            <AnchorPane>

                <HBox spacing="15"
                      AnchorPane.topAnchor="10"
                      AnchorPane.bottomAnchor="10"
                      AnchorPane.leftAnchor="10"
                      AnchorPane.rightAnchor="10">

                    <!-- ===== LEFT: MAIN TABLE ===== -->
                    <TableView fx:id="tblMalzemeler"
                               HBox.hgrow="ALWAYS"
                               prefWidth="650">

                        <columns>
                            <TableColumn fx:id="colAd"
                                         text="Material Name"
                                         prefWidth="150"/>

                            <TableColumn fx:id="colTur"
                                         text="Category"
                                         prefWidth="150"/>

                            <TableColumn fx:id="colStok"
                                         text="Stock"
                                         prefWidth="150"/>

                            <TableColumn fx:id="colDurum"
                                         text="Status"
                                         prefWidth="150"/>

                            <TableColumn fx:id="colSonGuncellenme"
                                         text="Last Updated"
                                         prefWidth="150"/>
                        </columns>

                    </TableView>

                    <!-- ===== RIGHT: FILTER + ACTIONS ===== -->
                    <VBox spacing="14"
                          prefWidth="240"
                          alignment="TOP_CENTER"
                          style="-fx-background-color:#f5f5f5;-fx-padding:15;">

                        <!-- FILTER TITLE -->
                        <Label text="Filter Materials"
                               style="-fx-font-size:15px;-fx-font-weight:bold;"/>

                        <!-- SEARCH -->
                        <TextField fx:id="txtAra"
                                   promptText="Search material..."
                                   maxWidth="Infinity"/>

                        <!-- CRITICAL -->
                        <HBox alignment="CENTER">
                            <CheckBox fx:id="chkKritik"
                                      text="Critical Stock"/>
                        </HBox>

                        <Separator/>

                        <!-- BUTTONS -->
                        <Button text="Add Material"
                                onAction="#onMalzemeEkle"
                                maxWidth="Infinity"
                                style="-fx-background-color:#2563EB;-fx-text-fill:white;-fx-font-weight:bold;"/>

                        <Button text="Update Material"
                                onAction="#onMalzemeGuncelle"
                                maxWidth="Infinity"
                                style="-fx-background-color:#0EA5E9;-fx-text-fill:white;-fx-font-weight:bold;"/>

                        <Button text="Delete Material"
                                onAction="#handleSil"
                                maxWidth="Infinity"
                                style="-fx-background-color:#DC2626;-fx-text-fill:white;-fx-font-weight:bold;"/>

                        <Button text="Add to Cart"
                                onAction="#onSepeteEkle"
                                maxWidth="Infinity"
                                style="-fx-background-color:#22C55E;-fx-text-fill:white;-fx-font-weight:bold;"/>

                    </VBox>

                </HBox>
            </AnchorPane>
        </Tab>

        <!-- ================= SEPET ================= -->
        <Tab text="My Cart">
            <AnchorPane>

                <HBox spacing="15"
                      AnchorPane.topAnchor="10"
                      AnchorPane.bottomAnchor="10"
                      AnchorPane.leftAnchor="10"
                      AnchorPane.rightAnchor="10">

                    <!-- ===== LEFT: CART TABLE ===== -->
                    <TableView fx:id="tblSepet"
                               HBox.hgrow="ALWAYS"
                               prefWidth="650">

                        <columns>
                            <TableColumn fx:id="colSepetAd"
                                         text="Material"
                                         prefWidth="150"/>

                            <TableColumn fx:id="colSepetKategori"
                                         text="Category"
                                         prefWidth="150"/>

                            <TableColumn fx:id="colSepetMiktar"
                                         text="Quantity"
                                         prefWidth="150"/>

                            <TableColumn fx:id="colSepetStok"
                                         text="Stock"
                                         prefWidth="150"/>

                            <TableColumn fx:id="colSepetDurum"
                                         text="Status"
                                         prefWidth="150"/>
                        </columns>

                    </TableView>

                    <!-- ===== RIGHT: FILTER + ACTIONS ===== -->
                    <VBox spacing="14"
                          prefWidth="240"
                          alignment="TOP_CENTER"
                          style="-fx-background-color:#f5f5f5;-fx-padding:15;">

                        <Label text="Filter Cart"
                               style="-fx-font-size:15px;-fx-font-weight:bold;"/>

                        <TextField fx:id="txtSepetAra"
                                   promptText="Search material..."
                                   maxWidth="Infinity"/>

                        <CheckBox fx:id="chkYetersiz"
                                  text="Critical Stock"/>

                        <Separator/>

                        <Button text="Remove Selected"
                                onAction="#onSepettenCikar"
                                maxWidth="Infinity"
                                style="-fx-background-color:#64748B;-fx-text-fill:white;-fx-font-weight:bold;"/>

                        <Button text="Clear Cart"
                                onAction="#onSepetiTemizle"
                                maxWidth="Infinity"
                                style="-fx-background-color:#DC2626;-fx-text-fill:white;-fx-font-weight:bold;"/>

                        <Button text="Approve Experiment"
                                onAction="#onDeneyOnayla"
                                maxWidth="Infinity"
                                style="-fx-background-color:#16A34A;-fx-text-fill:white;-fx-font-weight:bold;"/>

                    </VBox>

                </HBox>

            </AnchorPane>
        </Tab>


        <Tab text="Experiments">
            <AnchorPane>
                <HBox spacing="15"
                      AnchorPane.topAnchor="10"
                      AnchorPane.bottomAnchor="10"
                      AnchorPane.leftAnchor="10"
                      AnchorPane.rightAnchor="10">

                    <!-- TABLE -->
                    <TableView fx:id="tblDeneyler" HBox.hgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="colDeneyId" text="Experiment ID"/>
                            <TableColumn fx:id="colDeneyTarih" text="Date"/>
                            <TableColumn fx:id="colDeneyToplam" text="Total Materials"/>
                            <TableColumn fx:id="colDeneyMiktar" text="Total Quantity"/>
                            <TableColumn fx:id="colDeneyAciklama" text="Description"/>
                        </columns>
                    </TableView>

                    <!-- FILTER & ACTIONS -->
                    <VBox spacing="14"
                          prefWidth="240"
                          alignment="TOP_CENTER"
                          style="-fx-background-color:#f5f5f5;-fx-padding:15;">

                        <!-- FILTER -->
                        <Label text="Filter Experiments"
                               style="-fx-font-size:15px;-fx-font-weight:bold;"/>

                        <TextField fx:id="txtDeneyAra"
                                   promptText="Search experiment..."
                                   maxWidth="Infinity"/>

                        <Separator/>

                        <Button text="View Details"
                                onAction="#onDeneyDetay"
                                maxWidth="Infinity"
                                style="-fx-background-color:#2563EB;-fx-text-fill:white;-fx-font-weight:bold;"/>

                        <Button text="Delete Experiment"
                                onAction="#onDeneySil"
                                maxWidth="Infinity"
                                style="-fx-background-color:#DC2626;-fx-text-fill:white;-fx-font-weight:bold;"/>

                        <Button text="Refresh"
                                onAction="#loadDeneyler"
                                maxWidth="Infinity"
                                style="-fx-background-color:#64748B;-fx-text-fill:white;-fx-font-weight:bold;"/>

                    </VBox>

                </HBox>
            </AnchorPane>
        </Tab>

        <!-- ================= PROFÄ°L ================= -->
        <Tab text="My Profile">
            <AnchorPane>

                <VBox spacing="20"
                      alignment="TOP_CENTER"
                      AnchorPane.topAnchor="30"
                      AnchorPane.leftAnchor="30"
                      AnchorPane.rightAnchor="30">

                    <!-- ===== USER INFORMATION ===== -->
                    <VBox spacing="8" prefWidth="400">
                        <Label text="User Information"
                               style="-fx-font-size:16px;-fx-font-weight:bold;"/>

                        <TextField fx:id="txtProfilUsername"
                                   promptText="Username"
                                   disable="true"/>

                        <TextField fx:id="txtProfilEmail"
                                   promptText="Email"
                                   disable="true"/>

                        <TextField fx:id="txtProfilRole"
                                   promptText="Role"
                                   disable="true"/>
                    </VBox>

                    <Separator/>

                    <!-- ===== CHANGE PASSWORD ===== -->
                    <VBox spacing="10" prefWidth="400">
                        <Label text="Change Password"
                               style="-fx-font-size:16px;-fx-font-weight:bold;"/>

                        <PasswordField fx:id="txtEskiSifre"
                                       promptText="Current Password"/>

                        <PasswordField fx:id="txtYeniSifre"
                                       promptText="New Password"/>

                        <PasswordField fx:id="txtYeniSifreTekrar"
                                       promptText="New Password (Confirm)"/>

                        <Button text="Change Password"
                                onAction="#onSifreDegistir"
                                style="-fx-background-color:#2563EB;-fx-text-fill:white;-fx-font-weight:bold;"/>
                    </VBox>

                    <Separator/>

                    <!-- ===== SESSION ===== -->
                    <VBox spacing="10" prefWidth="400">
                        <Label text="Session"
                               style="-fx-font-size:16px;-fx-font-weight:bold;"/>

                        <Button text="Logout"
                                onAction="#onCikisYap"
                                style="-fx-background-color:#DC2626;-fx-text-fill:white;-fx-font-weight:bold;"/>
                    </VBox>

                </VBox>

            </AnchorPane>
        </Tab>

    </TabPane>
</AnchorPane>